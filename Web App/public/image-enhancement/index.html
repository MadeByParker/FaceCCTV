<!doctype html>
<html lang="en" id="web">
      <head>

      <!-- Custom CSS Files-->
      <link href="../assets/dist/tailwind.css" rel="stylesheet">
      <link href="../assets/css/global.css" rel="stylesheet">
      <link href="../assets/css/index.css" rel="stylesheet">

      <script src="../assets/dist/jquery-3.6.2.min.js"></script>

      <!-- Icons -->
      <link class="favicon" rel="apple-touch-icon" sizes="180x180" href="../assets/logos/logo-with-bg.png">
      <link class="favicon" rel="icon" type="image/png" sizes="32x32" href="../assets/logos/logo-with-bg.png">
      <link class="favicon" rel="icon" type="image/png" sizes="16x16" href="../assets/logos/logo-with-bg.png">
      <link class="favicon" rel="shortcut icon" href="../assets/logos/logo.ico">



      <!-- Meta Tags -->
      <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
      <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'"/>
      <meta http-equiv="X-Content-Security-Policy" content="default-src 'self'; script-src 'self'"/>
      <meta class="browser-theme" name="theme-color" content="#000000">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
      <meta charset="UTF-8" />

      <title>FaceCCTV Web | Face Detection and Enhancement Tool</title>
      </head>

      <body class="">
        <nav class="bg-gradient-to-r from-blue-400 to-blue-800">
            <div class="logo">
                <img id="navbar-logo-img" src="../assets/logos/app-icon.png" alt="logo" style="height: 48px; width: 48px;">
                <img id="navbar-brand-img" src="../assets/icons/text-logo.png" alt="logo" class="pl-2" style="height: 30px; width: 120px;">
            </div>
            <div class="hamburger">
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
            </div>
            <ul class="nav-links">
                <li><a class="p-4 transition-all ease-in-out duration-200 hover:text-white hover:bg-slate-400 hover:rounded-md"  href="../">Home</a></li>
                <li><a class="p-4 transition-all ease-in-out duration-200 hover:text-white hover:bg-slate-400 hover:rounded-md" href="../showcase">About</a></li>
                <li><a class="p-4 transition-all ease-in-out duration-200 hover:text-white hover:bg-slate-400 hover:rounded-md" href="../face-detection">Face Detection</a></li>
                <li><a class="p-4 transition-all ease-in-out duration-200 hover:text-white hover:bg-slate-400 hover:rounded-md" href="/">Image Enhancement</a></li>
                <li><a class="p-4 transition-all ease-in-out duration-200 hover:text-white hover:bg-slate-400 hover:rounded-md" href="../settings">Settings</a></li>
            </ul>
        </nav>
            <div class="">
                <div class="image-slider-container">
                    <figure class="cd-image-container">
                        <img class="slider-image" src="../assets/img/samples/enhanced.jpg" alt="Original Image">
                        <span class="cd-image-label" data-type="original">After</span>
            
                        <div class="cd-resize-img slider-image"> <!-- the resizable image on top -->
                                <img src="../assets/img/samples/original.jpg" alt="Modified Image">
                                <span class="cd-image-label" data-type="modified">Before</span>
                        </div>
            
                        <span class="cd-handle"></span>
                    </figure>
                </div>
            </div>
            <div class="mobile-bg"></div>
            <form id="my-form" action="http://127.0.0.1:8000/task/full-image-examination" method="POST" enctype="multipart/form-data">
                <label for="drag-drop">Upload your images for face detection and image enhancement.</label>
                <input type="file" name="images[]" id="drag-drop" multiple/>
                <div id="uploads"></div>
                <div class="dropzone" id="dropzone">Drag and drop the images</div>
                <button type="submit" class="card-button"><a>Submit</a></button>
            </form>
            <img src="" id="output_image" style="display: none;">
	        <a href="" id="download_link" style="display: none;" download>Download</a>

            <script>
                	// Send a request to the FastAPI endpoint on form submission
                    const form = document.querySelector('form');
                    form.addEventListener('submit', e => {
                        e.preventDefault();
                        const formData = new FormData(form);
                        fetch('/detect_face', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.blob())
                        .then(blob => {
                            const outputImage = document.querySelector('#output_image');
                            const downloadLink = document.querySelector('#download_link');
                            outputImage.src = URL.createObjectURL(blob);
                            outputImage.style.display = 'block';
                            downloadLink.href = outputImage.src;
                            downloadLink.style.display = 'block';
                        })
                        .catch(error => {
                            console.error('Error:', error);
                        });
                    });
            </script>
            
            <!--JS Imports -->
            <script src="../assets/js/index.js"></script>
            <script src="../assets/js/elements.js"></script>
            <script src="../assets/js/themes.js"></script>
            <script src="../assets/js/platform.js"></script>
            <script src="../assets/js/slider.js"></script>
            <script src="https://unpkg.com/flowbite@1.4.1/dist/flowbite.js"></script>

            <!-- Custom Libraries -->
            <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
            <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
      </body>
      
</html>     